/**
 * –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –¥–ª—è —ñ–≥—Ä–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∞.
 * –î–ª—è –≤–∏—Ä—ñ—à–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π –≥–æ—Ç–æ–≤—É —Ä–æ–∑–º—ñ—Ç–∫—É HTML —Ç–∞ –±–∞–∑–æ–≤—É —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—é.
 *
 * –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–Ω–µ–Ω–Ω—è –Ω–∞ –∫–Ω–æ–ø–∫—É "Start game"
 * –≤ –∫–æ–∂–Ω–æ–º—É –≤—ñ–∫–æ–Ω—Ü—ñ –ø–æ —á–µ—Ä–∑—ñ –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—å
 * —Å–º–∞–π–ª–∏–∫ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é –≤ 1 —Å–µ–∫—É–Ω–¥—É ('ü§ë' –∞–±–æ 'üëø')
 *
 * –ü—ñ–¥ —á–∞—Å –æ–±—Ä–æ–±–∫–∏ –∫–æ–∂–Ω–æ–≥–æ –≤—ñ–∫–æ–Ω—Ü—è —Å—Ç–≤–æ—Ä–∏ –º–∞—Å–∏–≤ –∑ Promis-–∞–º–∏
 * –≤ —è–∫–æ–º—É –∫–æ–∂–µ–Ω –∑ –Ω–∏—Ö –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –∑–∞ —Å–≤–æ—î –≤—ñ–∫–æ–Ω—Ü–µ,
 * –ø—ñ—Å–ª—è —á–æ–≥–æ –æ–±—Ä–æ–±–∏ –¥–∞–Ω–∏–π –º–∞—Å–∏–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É Promise.allSettled
 *
 * –ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –≤—Å—ñ –≤—ñ–∫–æ–Ω—Ü—è –±—É–ª–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ
 * —â–æ–± —Å–∫—Ä—ñ–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞–≤ —á–∏ –≥—Ä–∞–≤–µ—Ü—å –ø–µ—Ä–µ–º—ñ–≥, —á–∏ –Ω—ñ.
 * –Ø–∫—â–æ –≤ –∫–æ–∂–Ω–æ–º—É –≤—ñ–∫–æ–Ω—Ü—ñ –æ–¥–Ω–∞–∫–æ–≤–∏–π —Å–º–∞–π–ª–∏–∫ —Ü–µ –æ–∑–Ω–∞—á–∞—î —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–º—ñ–≥
 *
 * –í –ø–æ–ª–µ result –≤–∏–≤–æ–¥–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–∞—Ç—É—Å –≥—Ä–∏ ('Winner' –∞–±–æ 'Loser')
 *
 * –ü—ñ—Å–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –∫–Ω–æ–ø–∫—É "Start game"
 * –ø–æ–ª–µ –º–∞—î –æ—á–∏—â–∞—Ç–∏—Å—å, –∞ –≥—Ä–∞ –ø–æ—á–∏–Ω–∞—Ç–∏—Å—å –∑ –ø–æ—á–∞—Ç–∫—É.
 */

const startBtn = document.querySelector(".start-btn");
const container = document.querySelector(".container");
const result = document.querySelector(".result");

/*

1. –í—ñ—à–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ–π –ø–æ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç
1.1. —Å—Ç–≤–æ—Ä—é—î–º–æ –º–∞—Å–∏–≤ –≤—Å—ñ—Ö –∫–≤–∞–¥—Ä–∞—Ç–∏–∫—ñ–≤ ([...container.children])
1.2. –≤–∏–∫–ª–∏–∫–∞—î–º–æ –º–µ—Ç–æ–¥ map –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É –º–∞—Å–∏–≤—É –∫–≤–∞–¥—Ä–∞—Ç–∏–∫—ñ–≤ –∑ —Ü—ñ–ª–ª—é –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ –º–∞—Å–∏–≤ –∑ –ø—Ä–æ–º—ñ—Å–∞–º–∏
1.2.1. —Å—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–æ–º—ñ—Å —É —è–∫–æ–º—É —Ä–∞–Ω–¥–æ–º–Ω–æ –∑–∞–¥–∞—î–º–æ —Å–º–∞–π–ª–∏–∫

1.3. –≤–∏–∫–ª–∏–∫–∞—î–º–æ —Å—Ç–∞—Ç–∏—á–Ω–∏–π –º–µ—Ç–æ–¥ Promise.allSettled, —á–µ–∫–∞—î–º–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö –ø—Ä–æ–º—ñ—Å—ñ–≤ —ñ –æ–±—Ä–æ–±–ª—é—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –º–µ—Ç–æ–¥—ñ then
1.3.1. –ø–µ—Ä–µ–±–∏—Ä–∞—î–º–æ –º–∞—Å–∏–≤ –ø—Ä–æ–º—ñ—Å—ñ–≤ —Ç–∞ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é –≤ 1 —Å–µ–∫—É–Ω–¥—É –∑–∞–¥–∞—î–º–æ —Ç–µ–∫—Å—Ç–ö–æ–Ω—Ç–µ–Ω—Ç –∫–æ–∂–Ω–æ–º—É –∫–≤–∞–¥—Ä–∞—Ç–∏–∫—É —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –¥–æ —Å–º–∞–π–ª–∏–∫—É
1.3.2. –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø–µ—Ä–µ–º–æ–∂—Ü—è: —è–∫—â–æ –∫–æ–∂–µ–Ω –ø—Ä–æ–º—ñ—Å –∑ –º–∞—Å–∏–≤—É –º–∞—î –æ–¥–∏–Ω –π —Ç–µ–π —Å–∞–º–∏ —Å—Ç–∞–Ω - —Ç–æ –º–∏ –ø–µ—Ä–µ–º–æ–≥–ª–∏ (—è–∫—â–æ –≤—Å—ñ fullfilled –∞–±–æ —è–∫—â–æ –≤—Å—ñ rejected) —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –ø–æ–∫–∞–∑—É—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω—ñ —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–ö–æ–Ω–µ–Ω—Ç 
*/

startBtn.addEventListener("click", handleStart);

function handleStart() {
  result.textContent = "";

  const promises = [...container.children].map((item) => {
    return new Promise((res, rej) =>
      Math.random() > 0.5 ? res("ü§ë") : rej("üëø")
    );

    // return Math.random() > 0.5 ? Promise.resolve("ü§ë") : Promise.reject("üëø");
  });

  Promise.allSettled(promises).then((items) => {
    const isWinner =
      items.every(({ status }) => status === "fulfilled") ||
      items.every(({ status }) => status === "rejected");

    items.forEach((item, i) => {
      container.children[i].textContent = ""; // –ø–µ—Ä–µ–¥ —Ç–∏–º —è–∫ –ø–æ–∫–∞–∑–∞—Ç–∏ –Ω–æ–≤—ñ —Å–º–∞–π–ª–∏ - –æ—á–∏—â—É—î–º–æ –≤—Å—ñ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏
      setTimeout(() => {
        container.children[i].textContent = item.value || item.reason;

        // –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ —Ü–µ —Å–µ—Ç—Ç–∞–π–º–∞—É—Ç –¥–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å–º–∞–π–ª–∏–∫—É
        if (i === items.length - 1) {
          result.textContent = isWinner ? "Winner" : "Loser";
        }
      }, 1000 * (i + 1));
    });
  });
}
